// Test with overloaded constructors like in String
fn malloc(size: int) -> *byte;
fn strlen(str: *byte) -> int;
fn memcpy(dest: *byte, src: *byte, n: int) -> *void;

struct TestStruct {
    buffer: *byte;
    length: int;
    capacity: int;

    // Two constructors with same name but different parameters
    new(ptr: *char) {
        var len = 0;
        unsafe {
            len = strlen(ptr);
        }

        this.length = len;
        this.capacity = len + 1;

        unsafe {
            this.buffer = malloc(this.capacity);
            memcpy(this.buffer, ptr, len);
            var end_ptr = &this.buffer[len];
            *end_ptr = 0;
        }
    }

    new(cap: int) {
        this.length = 0;
        this.capacity = cap;
        if (cap < 1) {
            this.capacity = 1;
        }

        unsafe {
            this.buffer = malloc(this.capacity);
            *this.buffer = 0;
        }
    }
}

fn main() -> int {
    var s1 = new TestStruct("test");
    var s2 = new TestStruct(10);
    return 0;
}